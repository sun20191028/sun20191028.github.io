<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		kafka基础 | 
	 
	Hexo
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "wujun234.github.io";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3efe99c287df5a1d6f0d02d187e403c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<header id="header">
    <a id="title" href="/" class="logo">Hexo</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
	

	

		<li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li>
		<li class="menu-item">
			<a href="https://github.com/wujun234" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										db
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										mongodb
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/db/mongodb/%E8%84%9A%E6%9C%AC/">
										脚本
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										mysql
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/db/mysql/sql/">
										sql
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/db/mysql/%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/">
										运维操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										redis
									</a>
									
							<ul>
								<li class="file">
									<a href="/2019/11/21/db/redis/redis%20%E9%94%81%E3%80%81%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E3%80%81%E6%A7%BD/">
										redis 锁、一致性算法、槽
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/db/redis/redis%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/">
										redis基础操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/db/redis/%E5%BB%B6%E6%97%B6%E9%98%9F%E5%88%97/">
										延时队列
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										java基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2019/11/21/java%E5%9F%BA%E7%A1%80/jdk/">
										jdk
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/java%E5%9F%BA%E7%A1%80/jkd8/">
										jkd8
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/java%E5%9F%BA%E7%A1%80/%E5%AD%97%E7%AC%A6%E9%9B%86%E4%B8%8E%E7%BC%96%E7%A0%81/">
										字符集与编码
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/java%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8/">
										异常
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/java%E5%9F%BA%E7%A1%80/%E9%94%81/">
										锁
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										jvm
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/JVM%20%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80/">
										JVM 内存布局
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/class%20%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">
										class 文件结构
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/jvm-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">
										jvm-垃圾回收
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/jvm-%E5%B8%B8%E9%87%8F%E6%B1%A0/">
										jvm-常量池
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/jvm%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
										jvm类加载
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/linux%20%E5%AD%A6%E4%B9%A0/">
										linux 学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/">
										内存模型
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA/">
										内存溢出
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/%E6%80%BB%E7%BB%93/">
										总结
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/%E6%8C%87%E4%BB%A4/">
										指令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/jvm/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/">
										虚拟机性能监控工具
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/todolist/">
										todolist
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/todolist2/">
										todolist2
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										大数据
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hadoop
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E5%AE%89%E8%A3%85/">
										hadoop安装
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hbase
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/hbase/hbase%E5%AE%89%E8%A3%85/">
										hbase安装
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										工具
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/docker/docker%E5%9F%BA%E7%A1%80/">
										docker基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										idea
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/idea/idea%E9%A1%B9%E7%9B%AE%E7%AE%80%E4%BB%8B/">
										idea项目简介
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/idea/java%E5%90%AF%E5%8A%A8/">
										java启动
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/linux/%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0/">
										脚本学习
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										maven
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/maven/maven%E5%9F%BA%E7%A1%80/">
										maven基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B7%A5%E5%85%B7/maven/maven%E9%AB%98%E7%BA%A7/">
										maven高级
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/">
										常用操作
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C/">
										开发手册
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										框架
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										mybatis
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/mybatis/mybatis%E6%BA%90%E7%A0%81/">
										mybatis源码
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										spring
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										spring cloud
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/spring/spring%20cloud/spring%20cloud%20alibaba/">
										spring cloud alibaba
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/spring/spring%20cloud/spring%20cloud%E5%9F%BA%E7%A1%80/">
										spring cloud基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/spring/spring%20cloud/%E7%AC%94%E8%AE%B0/">
										笔记
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										spring core
									</a>
									
							<ul>
								<li class="file">
									<a href="/2019/11/21/%E6%A1%86%E6%9E%B6/spring/spring%20core/spring%20mvc%20%E5%9F%BA%E7%A1%80/">
										spring mvc 基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2019/11/21/%E6%A1%86%E6%9E%B6/spring/spring%20core/%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/">
										常用注解
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										spring mvc
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/spring/spring%20mvc/spring%20mvc%E6%BA%90%E7%A0%81%E4%B8%80/">
										spring mvc源码一
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/spring/spring%20mvc/spring%20mvc%E6%BA%90%E7%A0%81%E4%BA%8C/">
										spring mvc源码二
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tomcat
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/tomcat/servlet-filter-listener/">
										servlet-filter-listener
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/tomcat/session-cookies/">
										session-cookies
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										登录认证
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/JWT/">
										JWT
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/oauth2/">
										oauth2
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/03/05/%E6%A1%86%E6%9E%B6/%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/spring%20security/">
										spring security
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										消息队列
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										kafka
									</a>
									
							<ul>
								<li class="file active">
									<a href="/2021/03/05/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/kafka/kafka%E5%9F%BA%E7%A1%80/">
										kafka基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	kafka基础
</h1>
<div class="article-meta">
	
	<span>John Doe</span>
	<span>2021-03-05 15:07:56</span>
		<div id="article-categories">
    
		<span>Categories：</span>
            
    

    
		<span>Tags：</span>
            
    
		</div>

</div>

<div id="article-content">
	<h2 id="kafka概念"><a href="#kafka概念" class="headerlink" title="kafka概念"></a>kafka概念</h2><ul>
<li><input disabled="" type="checkbox"> 没有“中心主节点”的概念<br>集群中所有的服务器都是对等的，因此，可以在不做任何配置的更改的情况下实现服务器的的添加与删除(注册到zk集群同一目录下的kafka，统一纳入kafka集群管理，用于不同broker上对topic的备份)，同样的消息的生产者和消费者也能够做到随意重启和机器的上下线。</li>
</ul>
<ol>
<li><strong>broker</strong>: （节点/实例）一个独立的 Kafka 服务器就被称为 broker，broker 接收来自生产者的消息，为消息设置偏移量，并提交消息到磁盘保存。<strong>broker 集群</strong>：broker 是集群 的组成部分，broker 集群由一个或多个 broker 组成，每个集群都有一个 broker 同时充当了集群控制器的角色（自动从集群的活跃成员中选举出来）。</li>
<li><strong>消息</strong>：Kafka 中的数据单元被称为消息，也被称为记录<br> 批次：为了提高效率， 消息会分批次写入 Kafka，批次就代指的是一组消息</li>
<li><strong>主题</strong>：消息的种类称为 主题（Topic）,可以说一个主题代表了一类消息。相当于是对消息进行分类。</li>
<li><strong>分区</strong>：<strong>主题</strong>可以被分为<strong>若干个分区</strong>（partition），同一个主题中的分区可以不在一个机器上，有可能会部署在多个机器上，由此来实现 kafka 的伸缩性，单一主题中的分区有序，但是无法保证主题中所有的分区有序</li>
<li><strong>消费者分组</strong>：Group，用于归组同类消费者，在Kafka中，多个消费者可以共同消息一个Topic下的消息，每个消费者消费其中的部分消息，这些消费者就组成了一个分组，拥有同一个分组名称，通常也被称为消费者集群。</li>
<li><strong>偏移量</strong>：偏移量（Consumer Offset）是一种元数据，它是一个不断递增的整数值，用来记录消费者发生重平衡时的位置，以便用来恢复数据。</li>
<li><strong>副本</strong>：Kafka 中消息的备份又叫做 副本（Replica），副本的数量是可以配置的，Kafka 定义了两类副本：领导者副本（Leader Replica） 和 追随者副本（Follower Replica），<strong>前者对外提供服务，后者只是被动跟随</strong>。</li>
<li><strong>重平衡</strong>：Rebalance。消费者组内某个消费者实例挂掉后，其他消费者实例自动重新分配订阅主题分区的过程。Rebalance 是 Kafka 消费者端实现高可用的重要手段。</li>
</ol>
<h2 id="特性-优化"><a href="#特性-优化" class="headerlink" title="特性-优化"></a>特性-优化</h2><ol>
<li>为了减少磁盘写入的次数,broker会将消息暂时buffer起来,当消息的个数(或尺寸)达到一定阀值时,再flush到磁盘,这样减少了磁盘IO调用的次数。 </li>
<li>Broker没有副本机制，一旦broker宕机，该broker的消息将都不可用。Message消息是有多份的。</li>
<li>无状态导致消息的删除成为难题（可能删除的消息正在被订阅），kafka采用基于时间的SLA(服务水平保证)，消息保存一定时间（通常为7天）后会被删除。</li>
<li>消息订阅者可以rewind back到任意位置重新进行消费，当订阅者故障时，可以选择最小的offset(id)进行重新读取消费消息</li>
<li>partition中的每条Message包含了以下三个属性：<blockquote>
<p>offset      即：消息唯一标识:对应类型：long<br>MessageSize 对应类型：int32<br>data        是message的具体内容。</p>
</blockquote>
</li>
<li>在 kafka中,我们可以认为一个group是一个“订阅者”，一个Topic中的每个partions，只会被一个“订阅者”中的一个consumer消费，不过一个 consumer可以消费多个partitions中的消息（消费者数据小于Partions的数量时）。注意：kafka的设计原理决定，对于一个topic，同一个group中不能有多于partitions个数的consumer同时消费，否则将意味着某些consumer将无法得到消息。</li>
<li><strong>关闭了kafka 的自动创建topic功能，当此topic不存在时，客户端往此topic中发消息，只会提示发送失败，不会提示 此topic不存在</strong></li>
<li><strong>consumer订阅的是partition，而不是message</strong>，订阅到同一个partition的consumer必然属于不同的Consumer Group</li>
</ol>
<h2 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h2><h3 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h3><h4 id="是否自动创建主题"><a href="#是否自动创建主题" class="headerlink" title="是否自动创建主题"></a>是否自动创建主题</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">auto.create.topics.enable=false</span></span><br></pre></td></tr></table></figure>
<ul>
<li><input disabled="" type="checkbox"> 默认情况下，kafka 会使用三种方式来自动创建主题，下面是三种情况：</li>
<li>当一个生产者开始往主题写入消息时</li>
<li>当一个消费者开始从主题读取消息时</li>
<li>当任意一个客户端向主题发送元数据请求时</li>
<li>auto.create.topics.enable参数我建议最好设置成 false，即不允许自动创建 Topic。在我们的线上环境里面有很多名字稀奇古怪的 Topic，我想大概都是因为该参数被设置成了 true 的缘故。</li>
<li><input disabled="" type="checkbox"> 非常重要的topic  __consumer_offsets</li>
</ul>
<p> <strong>这个topic默认是单机的、不存在副本，通过下面的设置，可以解决问题</strong></p>
<ul>
<li>default.replication.factor=3</li>
<li>num.partitions=3<h4 id="主题默认设置"><a href="#主题默认设置" class="headerlink" title="主题默认设置"></a>主题默认设置</h4></li>
</ul>
<ol>
<li><p>num.partitions<br>num.partitions 参数指定了新创建的主题需要包含多少个分区。如果启用了主题自动创建功能（该功能是默认启用的），主题分区的个数就是该参数指定的值。该参数的默认值是 1。要注意，我们可以增加主题分区的个数，但不能减少分区的个数。</p>
</li>
<li><p>default.replication.factor<br>这个参数比较简单，它表示 kafka保存消息的副本数，如果一个副本失效了，另一个还可以继续提供服务default.replication.factor 的默认值为1，这个参数在你启用了主题自动创建功能后有效。</p>
</li>
<li><p>log.retention.ms<br>Kafka 通常根据时间来决定数据可以保留多久。默认使用 log.retention.hours 参数来配置时间，默认是 168 个小时，也就是一周。除此之外，还有两个参数 log.retention.minutes 和 log.retentiion.ms 。这三个参数作用是一样的，都是决定消息多久以后被删除，推荐使用 log.retention.ms。</p>
</li>
<li><p>log.retention.bytes<br>另一种保留消息的方式是判断消息是否过期。它的值通过参数 log.retention.bytes 来指定，作用在每一个分区上。也就是说，如果有一个包含 8 个分区的主题，并且 log.retention.bytes 被设置为 1GB，那么这个主题最多可以保留 8GB 数据。所以，当主题的分区个数增加时，整个主题可以保留的数据也随之增加。</p>
</li>
<li><p>log.segment.bytes<br>上述的日志都是作用在日志片段上，而不是作用在单个消息上。当消息到达 broker 时，它们被追加到分区的当前日志片段上，当日志片段大小到达 log.segment.bytes 指定上限（默认为 1GB）时，当前日志片段就会被关闭，一个新的日志片段被打开。如果一个日志片段被关闭，就开始等待过期。这个参数的值越小，就越会频繁的关闭和分配新文件，从而降低磁盘写入的整体效率。</p>
</li>
<li><p>log.segment.ms<br>上面提到日志片段经关闭后需等待过期，那么 log.segment.ms 这个参数就是指定日志多长时间被关闭的参数和，log.segment.ms 和 log.retention.bytes 也不存在互斥问题。日志片段会在大小或时间到达上限时被关闭，就看哪个条件先得到满足。</p>
</li>
<li><p>message.max.bytes<br>broker 通过设置 message.max.bytes参数来限制单个消息的大小，默认是 1000 000， 也就是 1MB，如果生产者尝试发送的消息超过这个大小，不仅消息不会被接收，还会收到 broker 返回的错误消息。跟其他与字节相关的配置参数一样，该参数指的是压缩后的消息大小，也就是说，只要压缩后的消息小于 mesage.max.bytes，那么消息的实际大小可以大于这个值<br>这个值对性能有显著的影响。值越大，那么负责处理网络连接和请求的线程就需要花越多的时间来处理这些请求。它还会增加磁盘写入块的大小，从而影响 IO 吞吐量。</p>
</li>
<li><p>retention.ms<br>规定了该主题消息被保存的时常，默认是7天，即该主题只能保存7天的消息，一旦设置了这个值，它会覆盖掉 Broker 端的全局参数值。</p>
</li>
<li><p>retention.bytes<br>retention.bytes：规定了要为该 Topic 预留多大的磁盘空间。和全局参数作用相似，这个值通常在多租户的 Kafka 集群中会有用武之地。当前默认值是 -1，表示可以无限使用磁盘空间。</p>
</li>
</ol>
<h2 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h2><h3 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h3><ul>
<li>enable.auto.commit 默认值true，表示消费者会周期性自动提交消费的offset</li>
<li>auto.commit.interval.ms 在enable.auto.commit 为true的情况下， 自动提交的间隔，默认值5000ms</li>
<li>max.poll.records 单次消费者拉取的最大数据条数，默认值</li>
<li>max.poll.interval.ms 默认值5分钟，表示若5分钟之内消费者没有消费完上一次poll的消息，那么consumer会主动发起离开group的请求</li>
</ul>
<blockquote>
<ol>
<li>auto.commit.interval.ms=30000、max.poll.records=5, 假如第一次poll5条数据，处理这些数据花费了20s。那么第二次拉取的时候，由于小于 30s。所以不会自动提交。只有当消费完第二次拉取的数据之后，发现40s&gt; 30s,才会提交一次</li>
<li>max.poll.interval.ms=5*60*1000 时 ，如果poll了5条数据，消费时间大于 5分钟，当前线程将离开消费组，当前线程订阅的topic的partition，将被释放。kafka 会进行重平衡，这5条数据，将会重新消费</li>
</ol>
</blockquote>
<ul>
<li>session.timeout.ms为会话的超时限制。如果consumer在这段时间内没有发送心跳信息，则它会被认为挂掉了，并且reblance将会产生，必须在[group.min.session.timeout.ms, group.max.session.timeout.ms]范围内。默认：10000</li>
</ul>
<h3 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h3><blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># acks = 0  如果设置为0，则 producer 不会等待服务器的反馈。该消息会被立刻添加到 socket buffer 中并认为已经发送完成。在这种情况下，服务器是否收到请求是没法保证的，并且参数retries也不会生效（因为客户端无法获得失败信息）。每个记录返回的 offset 总是被设置为-1</span></span><br><span class="line"><span class="comment"># acks = 1 如果设置为1，leader节点会将记录写入本地日志，并且在所有 follower 节点反馈之前就先确认成功。在这种情况下，如果 leader 节点在接收记录之后，并且在 follower 节点复制数据完成之前产生错误，则这条记录会丢失。</span></span><br><span class="line"><span class="comment"># acks = all 如果设置为all，这就意味着 leader 节点会等待所有同步中的副本确认之后再确认这条记录是否发送完成。只要至少有一个同步副本存在，记录就不会丢失。这种方式是对请求传递的最有效保证，acks=-1与acks=all是等效的。</span></span><br><span class="line"><span class="comment"># 可以设置的值为：all, -1, 0, 1</span></span><br><span class="line"><span class="meta">spring.kafka.producer.acks</span>=<span class="string">-1</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="操作kafka"><a href="#操作kafka" class="headerlink" title="操作kafka"></a>操作kafka</h2><h3 id="启动kafka-server"><a href="#启动kafka-server" class="headerlink" title="启动kafka-server"></a>启动kafka-server</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-server-start.sh config/server.properties</span><br></pre></td></tr></table></figure>
<h3 id="创建topic"><a href="#创建topic" class="headerlink" title="创建topic"></a>创建topic</h3><p><strong>.\kafka-topics.bat –zookeeper localhost:2181 –create –replication-factor 1 –partitions 1 –topic test0811</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> PS E:\java\kafka_cluster\kafka_1\bin\windows&gt; ./kafka-topics.bat --create --zookeeper 127.0.0.1:2181,127.0.0.1:2182,127.0.0.1:2183 --replication-factor 3 --partitions 3 --topic myPartitions1</span><br><span class="line"><span class="meta">#</span><span class="bash"> ./kafka-topics.bat --create --zookeeper 127.0.0.1:2181 --replication-factor 3 --partitions 3 --topic myPartitions1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 单个zk ，与zk集群是一样的</span></span><br><span class="line">Created topic myPartitions1.</span><br></pre></td></tr></table></figure>

<h3 id="创建producer"><a href="#创建producer" class="headerlink" title="创建producer"></a>创建producer</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kafka-console-producer.bat --broker-list localhost:9092 --topic test0811</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 然后在producer的界面输入 数据，按回车键，就可以在consumer中看到</p>
</blockquote>
<h3 id="创建consumer"><a href="#创建consumer" class="headerlink" title="创建consumer"></a>创建consumer</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kafka-console-consumer.bat --bootstrap-server localhost:9092 --topic test0811  --from-beginning</span><br></pre></td></tr></table></figure>

<h3 id="查看topic"><a href="#查看topic" class="headerlink" title="查看topic"></a>查看topic</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看topic</span></span><br><span class="line">PS E:\java\kafka_cluster\kafka_1\bin\windows&gt; ./kafka-topics.bat --list --zookeeper 127.0.0.1:2181</span><br><span class="line">myPartitions1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有topic的信息</span></span><br><span class="line">PS E:\java\kafka_cluster\kafka_1\bin\windows&gt; ./kafka-topics.bat --describe --zookeeper 127.0.0.1:2181</span><br><span class="line">Topic:myPartitions1     PartitionCount:3        ReplicationFactor:3     Configs:</span><br><span class="line">        Topic: myPartitions1    Partition: 0    Leader: 3       Replicas: 3,4,2 Isr: 3,4,2</span><br><span class="line">        Topic: myPartitions1    Partition: 1    Leader: 4       Replicas: 4,2,3 Isr: 4,2,3</span><br><span class="line">        Topic: myPartitions1    Partition: 2    Leader: 2       Replicas: 2,3,4 Isr: 2,3,4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看单个topic</span></span><br><span class="line">PS E:\java\kafka_cluster\kafka_1\bin\windows&gt; ./kafka-topics.bat --describe --zookeeper 172.16.24.3:2181 --topic oscarMedia</span><br><span class="line">Topic:oscarMedia        PartitionCount:6        ReplicationFactor:2     Configs:</span><br><span class="line">        Topic: oscarMedia       Partition: 0    Leader: 1       Replicas: 1,2   Isr: 1,2</span><br><span class="line">        Topic: oscarMedia       Partition: 1    Leader: 2       Replicas: 2,0   Isr: 2,0</span><br><span class="line">        Topic: oscarMedia       Partition: 2    Leader: 0       Replicas: 0,1   Isr: 0,1</span><br><span class="line">        Topic: oscarMedia       Partition: 3    Leader: 1       Replicas: 1,0   Isr: 1,0</span><br><span class="line">        Topic: oscarMedia       Partition: 4    Leader: 2       Replicas: 2,1   Isr: 2,1</span><br><span class="line">        Topic: oscarMedia       Partition: 5    Leader: 0       Replicas: 0,2   Isr: 0,2</span><br><span class="line"><span class="meta">#</span><span class="bash"> describe中信息非常明确，分片0中3为leader，3在分片1、分片2中各一有一个副本</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 也可以连接zk，然后如下查看</span></span><br><span class="line">ls /config/topics</span><br></pre></td></tr></table></figure>

<h3 id="查看消费者组"><a href="#查看消费者组" class="headerlink" title="查看消费者组"></a>查看消费者组</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> zookeeper 中执行</span></span><br><span class="line">ls  /consumers</span><br><span class="line"><span class="meta">#</span><span class="bash"> kafka 查看</span></span><br><span class="line">.\kafka-consumer-groups.bat  --bootstrap-server localhost:9092  --list</span><br></pre></td></tr></table></figure>

<h3 id="查看消费者位置"><a href="#查看消费者位置" class="headerlink" title="查看消费者位置"></a>查看消费者位置</h3><p>​        <strong>.\kafka-consumer-groups.bat –bootstrap-server localhost:9094 –describe –group my-group1</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.\kafka-consumer-groups.bat --bootstrap-server localhost:9094 --describe --group my-group1</span><br><span class="line"></span><br><span class="line">TOPIC           PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                     HOST            CLIENT-ID</span><br><span class="line">				分区名称    当前offset位置   日志结尾处offset  剩余未消费  		消费者id</span><br><span class="line">myPartitions1   2          568             3985            3417            consumer-3-cacaae9c-5d98-4b37-8774-6a89159fa123 /192.168.100.24 consumer-3</span><br><span class="line">myPartitions1   0          544             3984            3440            consumer-1-93384eb5-7eec-41ac-bb6a-0fa8c37b4f2e /192.168.100.24 consumer-1</span><br><span class="line">myPartitions1   1          559             3983            3424            consumer-2-7d4092f2-04c9-4955-a847-9e0c0d282c00 /192.168.100.24 consumer-2</span><br></pre></td></tr></table></figure>

<blockquote>
<p> <strong>在0.9.0.0，kafka.tools.ConsumerOffsetChecker已经不支持了。你应该使用kafka.admin.ConsumerGroupCommand 或 bin/kafka-consumer-groups.sh脚本来管理消费者组，包括用新消费者API创建的消费者。</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-run-class.sh kafka.tools.ConsumerOffsetChecker --zkconnect localhost:2181 --group test</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="删除topic"><a href="#删除topic" class="headerlink" title="删除topic"></a>删除topic</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\kafka-topics.bat --zookeeper localhost:2181 --delete --topic test0811</span><br></pre></td></tr></table></figure>
<blockquote>
<p>因为kafaka配置文件中server.properties没有配置delete.topic.enable=true，此时的删除并不是真正的删除，只是把topic标记为：marked for deletion<br>你可以通过命令：./bin/kafka-topics –zookeeper {zookeeper server} –list 来查看所有topic<br>如果想真正删除，</p>
</blockquote>
<ol>
<li>掉命令删除<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/kafka-topics --delete --zookeeper 【zookeeper server:port】 --topic 【topic name】</span><br></pre></td></tr></table></figure></li>
<li>在zk中删除<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rmr /brokers/topics/[topic name]</span><br><span class="line">rmr  /admin/delete_topics/[topic name]</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>数据日志在 kafka 安装目录的config 中的 server.properties 中<br>由<br><strong>log.dirs=/tmp/kafka-logs</strong> 指定</p>
<h2 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h2><h4 id="1-不同的kafka集群怎么连接同一个-zk？"><a href="#1-不同的kafka集群怎么连接同一个-zk？" class="headerlink" title="1. 不同的kafka集群怎么连接同一个 zk？"></a>1. 不同的kafka集群怎么连接同一个 zk？</h4><blockquote>
<p>kafka的配置文件 server.propertities 里面，有个配置项 zookeeper.connect ,不同的kafka集群如果需要配置在同一个Zookeeper上，只需要修改后面的节点目录就可以。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zk-node1:2181,zk-node2:2181,zk-node3:2181&#x2F;kafka_cluster1</span><br><span class="line">zk-node1:2181,zk-node2:2181,zk-node3:2181&#x2F;kafka_cluster2</span><br></pre></td></tr></table></figure>
<h4 id="4-broker-、分片数-、消费者线程数关系"><a href="#4-broker-、分片数-、消费者线程数关系" class="headerlink" title="4.  broker 、分片数 、消费者线程数关系"></a>4.  broker 、分片数 、消费者线程数关系</h4><ul>
<li><p>当线程数 = 分区数，一个分区一个线程消费<br><img src="https://img-blog.csdnimg.cn/20200426153645257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21lbmd4aWFuZ3FpaGFuZ3o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>当线程数&lt;分区数  一个线程需要消费多个分区的数据<br>Setting newly assigned partitions [myPartitions1-2, myPartitions1-1, myPartitions1-0]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">internals.AbstractCoordinator (AbstractCoordinator.java:<span class="number">509</span>) - [Consumer clientId=consumer-<span class="number">1</span>, groupId=my-group1] (Re-)joining group</span><br><span class="line">internals.AbstractCoordinator$<span class="number">1</span> (AbstractCoordinator.java:<span class="number">473</span>) - [Consumer clientId=consumer-<span class="number">1</span>, groupId=my-group1] Successfully joined group with generation <span class="number">9</span></span><br><span class="line">internals.ConsumerCoordinator (ConsumerCoordinator.java:<span class="number">280</span>) - [Consumer clientId=consumer-<span class="number">1</span>, groupId=my-group1] Setting newly assigned partitions [myPartitions1-<span class="number">2</span>, myPartitions1-<span class="number">1</span>, myPartitions1-<span class="number">0</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>当线程数 &gt; 分区数</p>
</li>
</ul>
<p><strong>超过的线程，不参与消费</strong><br>kafka4个节点、4个分片、消费者4个线程，但是消费者有集群，2台机器的情况。新机器加入的时候，会触发重平衡，但是 超过的线程依然不会消费。<br>比如扩容情况<br>4节点、4分片、单机4线程消费，扩容到<br>4kafka节点、8分片、2台4线程消费，触发重平衡，是有效的。<br><img src="https://img-blog.csdnimg.cn/20200426153853365.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21lbmd4aWFuZ3FpaGFuZ3o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="3-对于已经创建的topic，只有单片类型，均匀分布在各个-kafka节点上面，怎么创建副本"><a href="#3-对于已经创建的topic，只有单片类型，均匀分布在各个-kafka节点上面，怎么创建副本" class="headerlink" title="3. 对于已经创建的topic，只有单片类型，均匀分布在各个 kafka节点上面，怎么创建副本"></a>3. 对于已经创建的topic，只有单片类型，均匀分布在各个 kafka节点上面，怎么创建副本</h4><p>都<strong>不用重启</strong>，直接<strong>编辑下面的json保存好</strong>，执行<strong>下面的脚本</strong>就可以了。<br>replicas里面的数组需要是现有的各个节点（即broker.id)，此操作，只是让 kafka对主文件，进行副本备份，并不会改变其原来主文件的分布</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\kafka-reassign-partitions.bat --zookeeper localhost:2181,localhost:2183,localhost:2183 --reassignment-json-file E:\java\kafka_cluster\consumer_offsets_replication.json --execute</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;version&quot;</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="attr">&quot;partitions&quot;</span>: [</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">1</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">2</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">3</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">4</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">5</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">6</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">7</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">8</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">9</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">10</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">11</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">12</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">13</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">14</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">15</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">16</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">4</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">17</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">18</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">19</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">20</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">21</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">22</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">23</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">24</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">25</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">26</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">27</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">28</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">29</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">30</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">31</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">32</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">33</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">34</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">35</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">36</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">37</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">38</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">39</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">40</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">41</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">42</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">43</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">44</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">45</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">46</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">47</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">48</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">&quot;topic&quot;</span>: <span class="string">&quot;__consumer_offsets&quot;</span>,</span><br><span class="line">			<span class="attr">&quot;partition&quot;</span>: <span class="number">49</span>,</span><br><span class="line">			<span class="attr">&quot;replicas&quot;</span>: [</span><br><span class="line">				<span class="number">2</span>,</span><br><span class="line">				<span class="number">3</span>,</span><br><span class="line">				<span class="number">4</span></span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-为什么要使用kafka集群"><a href="#4-为什么要使用kafka集群" class="headerlink" title="4. 为什么要使用kafka集群"></a>4. 为什么要使用kafka集群</h4><ol>
<li>业务流程上进行解耦<br>对于一些用户非常敏感的数据（比如gps点采集），将数据上传与数据处理进行分离，后续数据处理出现问题或者升级的时候，不影响用户体验。</li>
<li>方便做削峰处理。用户数据不规律，网络波动，导致某个点并发特别高，从而导致系统崩溃。</li>
<li>可以用于做 异步通信</li>
<li>日志的统一处理。日常的日志通常都分布在各个集群的节点上。</li>
</ol>
<h2 id="客户端配置-1"><a href="#客户端配置-1" class="headerlink" title="客户端配置"></a>客户端配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">broker.id&#x3D;2 #节点id</span><br><span class="line">port&#x3D;9092</span><br><span class="line">log.dirs&#x3D;E:\\java\\kafka_cluster\\log\\k1 # 消息日志存放地址</span><br><span class="line">num.recovery.threads.per.data.dir&#x3D;1 # Kafka 会使用可配置的线程池来处理日志片段。</span><br></pre></td></tr></table></figure>


</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2021/03/05/java%E5%9F%BA%E7%A1%80/jkd8/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2021/03/05/%E6%A1%86%E6%9E%B6/%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/spring%20security/">
                spring security
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// 评论
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: '',
			appKey: '',
			placeholder: '请输入评论',
			avatar: 'retro',
			recordIP: false
		})
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">John Doe</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>